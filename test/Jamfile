# Copyright 2025 Matt Borland
# Distributed under the Boost Software License, Version 1.0.
# https://www.boost.org/LICENSE_1_0.txt

require-b2 5.0.1 ;
import-search /boost/config/checks ;
import config : requires ;
import modules ;
import testing ;

project : requirements

    <warnings>extra

    <toolset>gcc:<cxxflags>-Wsign-conversion
    <toolset>gcc:<cxxflags>-Wconversion
    <toolset>gcc:<cxxflags>-Wundef
    <toolset>gcc:<cxxflags>-Wold-style-cast
    <toolset>gcc:<cxxflags>-Wfloat-equal
    <toolset>gcc:<cxxflags>-Wshadow
    <toolset>gcc:<cxxflags>-Wcast-qual
    <toolset>gcc:<cxxflags>-Wcast-align
    <toolset>gcc:<cxxflags>-Wlogical-op
    <toolset>gcc:<cxxflags>-Wdouble-promotion
    <toolset>gcc:<cxxflags>-Wformat=2
    <toolset>gcc:<cxxflags>-Wstack-protector

    <toolset>clang:<cxxflags>-Wsign-conversion
    <toolset>clang:<cxxflags>-Wconversion
    <toolset>clang:<cxxflags>-Wundef
    <toolset>clang:<cxxflags>-Wold-style-cast
    <toolset>clang:<cxxflags>-Wfloat-equal
    <toolset>clang:<cxxflags>-Wshadow
    <toolset>clang:<cxxflags>-Wcast-qual
    <toolset>clang:<cxxflags>-Wcast-align
    <toolset>clang:<cxxflags>-Wdouble-promotion
    <toolset>clang:<cxxflags>-Wformat=2
    <toolset>clang:<cxxflags>-Wnull-dereference
    <toolset>clang:<cxxflags>-Wthread-safety
    <toolset>clang:<cxxflags>-Wunused-lambda-capture
    <toolset>clang:<cxxflags>-Wassign-enum

    <toolset>msvc:<warnings-as-errors>on
    <toolset>clang:<warnings-as-errors>on
    <toolset>gcc:<warnings-as-errors>on

  [ requires cxx17_hdr_charconv cxx20_hdr_bit cxx20_hdr_compare cxx20_hdr_concepts cxx20_hdr_format ]
  ;

run quick.cpp ;

run test_construct_unsigned_type.cpp ;
compile test_integer_type_properties.cpp ;

run test_unsigned_addition.cpp ;
compile-fail test_unsigned_addition_fail.cpp ;

run-fail benchmarks/benchmark_unsigned_addition.cpp ;
